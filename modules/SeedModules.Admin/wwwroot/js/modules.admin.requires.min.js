define("SeedModules.Admin/modules/admin/directives/sidebar",["require","exports","SeedModules.Admin/modules/admin/module"],function(e,s,o){"use strict";function r(){return{restrict:"AE",replace:!0,template:'<div class="sidebar"><div class="sidebar-top"><a href="" ng-click="toggle()"><i class="fas fa-bars fa-fw"></i></a></div><ul sidebar-nav nav-data="navData"></ul></div>',scope:{sidebar:"=",navData:"="},controller:i}}s.__esModule=!0;var i=function(){function e(e,s){this.$scope=e,this.$element=s,s=$(s),e.toggle=function(){var e=s.find(".sidebar-item.sidebar-show"),o=s.find(".sidebar-item"),r=$(".sidebar-content");s.hasClass("sidebar-mini")?(s.removeClass("sidebar-mini"),r.removeClass("sidebar-mini")):(e.removeClass("sidebar-show"),o.children("ul").removeAttr("style"),s.addClass("sidebar-mini"),r.addClass("sidebar-mini"))},e.sidebar=$.extend(e.sidebar,{toggle:e.toggle})}return e.$inject=["$scope","$element"],e}();o.directive("sidebar",r)}),define("SeedModules.Admin/modules/admin/directives/sidebarNav",["require","exports","SeedModules.Admin/modules/admin/module","angular"],function(e,s,o,r){"use strict";function i(){return{restrict:"AE",replace:!0,template:'<ul><li class="sidebar-item" ng-repeat="item in navData" ng-include="\'/SeedModules.Admin/modules/admin/templates/navItem.html\'"></li></ul>',scope:{navData:"="},controller:t}}s.__esModule=!0;var t=function(){function e(e,s,o){this.$scope=e,this.$element=s,this.$timeout=o,s=$(s),e.isLeaf=function(e){return!e.children||e.children.length<=0},e.warpClick=function(o,i){if(e.isLeaf(o))(o.itemClicked?o.itemClicked:r.noop)({$item:o,$event:i});else{var t=s.parent(".sidebar"),n=$(i.currentTarget),l=t.find(".sidebar-item.sidebar-show"),a=t.find(".sidebar-item");t.hasClass("sidebar-mini")||("none"==n.next().css("display")?(a.children("ul").slideUp(300),n.next("ul").slideDown(300),n.parent("li").addClass("sidebar-show").siblings("li").removeClass("sidebar-show")):(n.next("ul").slideUp(300),l.removeClass("sidebar-show")))}}}return e.$inject=["$scope","$element","$timeout"],e}();o.directive("sidebarNav",i)}),define("SeedModules.Admin/modules/admin/controllers/admin",["require","exports","SeedModules.Admin/modules/admin/module"],function(e,s,o){"use strict";s.__esModule=!0,o.controller("SeedModules.Admin/modules/admin/controllers/admin",["$scope","$state","$modal","$window","app/services/popupService","SeedModules.Admin/modules/admin/configs/nav","SeedModules.AngularUI/modules/services/requestService","SeedModules.AngularUI/modules/factories/schemaFormParams",function(e,s,o,r,i,t,n,l){e.passwordFormParams=(new l).properties({currentPassword:{title:"当前密码",type:"string",required:!0},password:{title:"新密码",type:"string",required:!0},confirmPassword:{title:"密码确认",type:"string",required:!0}}),e.passwordForm=[{key:"currentPassword",type:"password"},{key:"password",type:"password"},{key:"confirmPassword",type:"password",validationMessage:{compare:"密码不一致"},compare:function(e,s,o){return e===s.password}}],e.sidebar={},e.navData=t.tree(),e.logout=function(){i.confirm("是否退出？").ok(function(){n.url("/api/account/logout").options({dataOnly:!0}).post().result.then(function(){r.location.reload()})})},e.changePassword=function(){o.open({templateUrl:"/SeedModules.AngularUI/modules/views/schemaConfirm.html",size:"sm",data:{title:"修改密码",formParams:e.passwordFormParams,form:e.passwordForm,model:{}}}).result.then(function(e){n.url("/api/admin/users/password").patch(e).result.then(function(){i.information("修改成功")})})}}])}),define("SeedModules.Admin/modules/admin/controllers/dashboard",["require","exports","SeedModules.Admin/modules/admin/module"],function(e,s,o){"use strict";s.__esModule=!0,o.controller("SeedModules.Admin/modules/admin/controllers/dashboard",["$scope",function(e){}])}),define("SeedModules.Admin/modules/admin/controllers/users",["SeedModules.Admin/modules/admin/module"],function(e){"use strict";e.controller("SeedModules.Admin/modules/admin/controllers/users",["$scope","$modal","$q","$timeout","app/services/popupService","SeedModules.AngularUI/modules/services/requestService","SeedModules.AngularUI/modules/factories/ngTableRequest","SeedModules.AngularUI/modules/factories/schemaFormParams",function(e,s,o,r,i,t,n,l){e.search={keyword:""},e.tableParams=new n({url:"/api/admin/users/query",showLoading:!1,data:e.search}).ngTableParams(),e.formParams=(new l).properties({username:{title:"用户名",type:"string",required:!0},lastName:{title:"姓",type:"string"},firstName:{title:"名",type:"string"},email:{title:"邮箱",type:"string",required:!0},password:{title:"初始密码",type:"string",required:!0},confirmPassword:{title:"密码确认",type:"string",required:!0}}),e.form=["username",{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:"col-xs-6",items:["lastName"]},{type:"section",htmlClass:"col-xs-6",items:["firstName"]}]},"email",{type:"section",htmlClass:"row",items:[{type:"section",htmlClass:"col-xs-6",items:[{key:"password",type:"password"}]},{type:"section",htmlClass:"col-xs-6",items:[{key:"confirmPassword",type:"password",validationMessage:{compare:"密码不一致"},compare:function(e,s,o){return e===s.password}}]}]}],e.keywordCallback=function(){},e.create=function(){s.open({templateUrl:"/SeedModules.AngularUI/modules/views/schemaConfirm.html",data:{title:"新建用户",formParams:e.formParams,form:e.form}}).result.then(function(s){t.url("/api/admin/users").post(s).result.then(function(s){e.tableParams.reload()})})},e.resetPassword=function(e){s.open({templateUrl:"/SeedModules.AngularUI/modules/views/schemaConfirm.html",size:"sm",data:{title:"重置密码",formParams:(new l).properties({password:{title:"新密码",type:"string",required:!0}}),form:[{key:"password",type:"password"}],model:{}}}).result.then(function(s){t.url("/api/admin/users/password/"+e.id).patch(s).result.then(function(e){i.information("重置成功")})})},e.drop=function(s){i.confirm("是否删除用户？").ok(function(){t.url("/api/admin/users/"+s.id).drop().result.then(function(s){e.tableParams.reload()})})}}])}),define("SeedModules.Admin/modules/admin/controllers/roles",["require","exports","SeedModules.Admin/modules/admin/module","angular","jquery"],function(e,s,o,r,i){"use strict";s.__esModule=!0;var t=function(){function e(e,s,o,t,n,l,a){var d=this;this.$scope=e,this.$rootScope=s,this.$modal=o,this.popupService=t,this.requestService=n,this.ngTableRequest=l,this.schemaFormParams=a,e.vm=this,e.roles=[],e.currentRole=null,e.tableParams=null,e.tableRequest=new l({showLoading:!1}),e.checkedAll=!1,e.checked={},e.permissions=[],e.roleEnables=[],e.roleForm=(new a).properties({rolename:{title:"名称",type:"string",required:!0}}),e.cancelEditing=function(){e.currentRole=null},e.create=function(){o.open({templateUrl:"/SeedModules.AngularUI/modules/views/schemaConfirm.html",size:"sm",scope:r.extend(s.$new(),{$data:{title:"新建角色",formParams:e.roleForm,form:["rolename"]}})}).result.then(function(e){n.url("/api/admin/roles").post(e).result.then(function(e){d.loadRoles()})})},e.drop=function(){t.confirm("是否删除角色？").ok(function(){n.url("/api/admin/roles/"+e.currentRole.id).drop().result.then(function(s){e.currentRole=null,d.loadRoles()})})},e.setName=function(e){o.open({templateUrl:"/SeedModules.AngularUI/modules/views/schemaConfirm.html",size:"sm",scope:r.extend(d.$rootScope.$new(),{$data:{title:"设置别名",formParams:(new a).properties({displayName:{title:"别名",type:"string"}}),form:["displayName"]}})}).result.then(function(s){n.url("/api/admin/roles/"+e.id+"/displayname?name="+(s.displayName||"")).patch().result.then(function(e){d.loadRoles()})})},e.addMember=function(){e.currentRole&&o.open({templateUrl:"/SeedModules.Admin/modules/admin/views/members.html",size:"lg",scope:r.extend(s.$new(),{data:{role:e.currentRole}})}).result.then(function(s){var o=[];i.each(s,function(e,s){s&&o.push(e)}),o.length<=0||n.url("/api/admin/roles/"+e.currentRole.id+"/members").post({members:o}).result.then(function(s){e.tableParams&&e.tableParams.reload()})})},e.removeMember=function(s){e.currentRole&&t.confirm("是否删除成员？").ok(function(){var o=[];s?o.push(s.id):i.each(e.checked,function(e,s){s&&o.push(e)}),o.length<=0||n.url("/api/admin/roles/"+e.currentRole.id+"/members").patch({members:o}).result.then(function(s){e.tableParams&&e.tableParams.reload()})})},e.$watch(function(){return e.currentRole},function(e){d.loadRoleDetails(e),d.loadRolePermissions(e)})}return e.prototype.checkAll=function(){var e=this;this.$scope.checkedAll=!this.$scope.checkedAll,this.$scope.checkedAll?r.forEach(this.$scope.tableParams.data,function(s){e.$scope.checked[s.id]=!0}):r.forEach(this.$scope.tableParams.data,function(s){e.$scope.checked[s.id]=!1})},e.prototype.onCheck=function(){var e=this;this.$scope.checkedAll=!0,r.forEach(this.$scope.tableParams.data,function(s){if(!e.$scope.checked[s.id])return e.$scope.checkedAll=!1,!1})},e.prototype.loadRoles=function(){var e=this;this.requestService.url("/api/admin/roles").options({showLoading:!1}).get().result.then(function(s){e.$scope.roles=s})},e.prototype.selectRole=function(e){this.$scope.currentRole=e},e.prototype.loadRoleDetails=function(e){this.$scope.checkedAll=!1,this.$scope.checked={},e&&(this.$scope.tableParams=this.$scope.tableRequest.options({url:"/api/admin/roles/"+e.id+"/members/query"}).ngTableParams())},e.prototype.loadRolePermissions=function(e){var s=this;this.$scope.permissions=[],this.$scope.roleEnables=[],e&&this.requestService.url("/api/admin/roles/"+e.id+"/permission").options({showLoading:!1}).get().result.then(function(e){s.$scope.permissions=e.permissions,s.$scope.roleEnables=e.enables})},e.prototype.hasPermission=function(e){return!!this.$scope.roleEnables&&this.$scope.roleEnables.indexOf(e.name)>=0},e.prototype.permissionChanged=function(e){var s=this.$scope.roleEnables.indexOf(e.name);s>=0?this.$scope.roleEnables.splice(s,1):this.$scope.roleEnables.push(e.name)},e.prototype.isAllPermission=function(e){for(var s=this.$scope.permissions[e],o=0;o<s.length;o++)if(this.$scope.roleEnables.indexOf(s[o].name)<0)return!1;return!0},e.prototype.changeAllPermission=function(e){var s=this.isAllPermission(e),o=this.$scope.permissions[e];if(s)for(var r=0;r<o.length;r++){var i=this.$scope.roleEnables.indexOf(o[r].name);i>=0&&this.$scope.roleEnables.splice(i,1)}else for(var r=0;r<o.length;r++)this.$scope.roleEnables.indexOf(o[r].name)<0&&this.$scope.roleEnables.push(o[r].name)},e.prototype.saveRolePermission=function(){var e=this;this.$scope.currentRole&&this.requestService.url("/api/admin/roles/"+this.$scope.currentRole.id+"/permission").put(this.$scope.roleEnables).result.then(function(){e.popupService.information("保存成功")})},e.$inject=["$scope","$rootScope","$modal","app/services/popupService","SeedModules.AngularUI/modules/services/requestService","SeedModules.AngularUI/modules/factories/ngTableRequest","SeedModules.AngularUI/modules/factories/schemaFormParams"],e}();o.controller("SeedModules.Admin/modules/admin/controllers/roles",t)}),define("SeedModules.Admin/modules/admin/controllers/members",["require","exports","SeedModules.Admin/modules/admin/module"],function(e,s,o){"use strict";s.__esModule=!0,o.controller("SeedModules.Admin/modules/admin/controllers/members",["$scope","SeedModules.AngularUI/modules/services/requestService","SeedModules.AngularUI/modules/factories/ngTableRequest",function(e,s,o){e.tableParams=new o({url:"/api/admin/roles/"+e.$data.role.id+"/notmembers/query",showLoading:!1}).ngTableParams({count:30},{counts:[]}),e.selected={},e.onCheck=function(s){e.selected[s.id]=!e.selected[s.id]}}])}),define("SeedModules.Admin/modules/admin/controllers/settings",["require","exports","SeedModules.Admin/modules/admin/module"],function(e,s,o){"use strict";s.__esModule=!0;var r=function(){function e(e,s){this.$scope=e,this.schemaFormParams=s,e.formParams=new s,e.form=[]}return e.$inject=["$scope","SeedModules.AngularUI/modules/factories/schemaFormParams"],e}();o.controller("SeedModules.Admin/modules/admin/controllers/settings",r)}),define("SeedModules.Admin/modules/admin/requires",["require","exports","SeedModules.Admin/modules/admin/directives/sidebar","SeedModules.Admin/modules/admin/directives/sidebarNav","SeedModules.Admin/modules/admin/controllers/admin","SeedModules.Admin/modules/admin/controllers/dashboard","SeedModules.Admin/modules/admin/controllers/users","SeedModules.Admin/modules/admin/controllers/roles","SeedModules.Admin/modules/admin/controllers/members","SeedModules.Admin/modules/admin/controllers/settings"],function(e,s){"use strict";s.__esModule=!0});