define("SeedModules.PageBuilder/modules/components/builder/page",["require","exports","SeedModules.PageBuilder/modules/module"],function(e,o,t){"use strict";o.__esModule=!0;var s=function(){function e(e,o,t,s){this.$scope=e,this.$state=o,this.$modal=t,this.popupService=s,e.page=this,e.search={keyword:""},e.pages=[]}return e.prototype.keywordCallback=function(){},e.prototype.preview=function(e){this.$modal.open({templateUrl:"/SeedModules.PageBuilder/modules/components/builder/preview.html",size:"lg"})},e.prototype.add=function(){this.$state.go("admin.pagebuilder_pageform")},e.prototype.edit=function(e){this.$state.go("admin.pagebuilder_pageform",{id:e})},e.prototype.drop=function(){this.popupService.confirm("是否删除？").ok(function(){})},e.$inject=["$scope","$state","$modal","app/services/popupService"],e}();t.controller("SeedModules.PageBuilder/modules/components/builder/page",s)}),define("SeedModules.PageBuilder/modules/components/server/settings",["require","exports","SeedModules.PageBuilder/modules/module"],function(e,o,t){"use strict";o.__esModule=!0;var s=function(){function e(e){this.$scope=e}return e.$inject=["$scope"],e}();t.controller("SeedModules.PageBuilder/modules/components/server/settings",s)}),define("SeedModules.AngularUI/modules/configs/enums/schemaTypes",["require","exports"],function(e,o){"use strict";o.__esModule=!0;var t;!function(e){e.object="object"}(t=o.SchemaTypes||(o.SchemaTypes={}))}),define("SeedModules.PageBuilder/modules/components/builder/pageForm",["require","exports","SeedModules.PageBuilder/modules/module","angular","SeedModules.AngularUI/modules/configs/enums/schemaTypes","SeedModules.AngularUI/modules/configs/enums/defaultFormTypes","rcss!/SeedModules.PageBuilder/css/page-builder.css"],function(e,o,t,s,r,n){"use strict";o.__esModule=!0;var i=function(){function e(e,o,t,s,n,i){this.$scope=e,this.$rootScope=o,this.$state=t,this.$modal=s,this.toolsBuilder=n,this.ngTableParams=i,e.pg=this,e.form={form:[{key:"pagename",title:"页面名称",placeholder:"输入页面名称",required:!0}],schema:{type:r.SchemaTypes.object,properties:{pagename:{type:"string"}}},options:{},model:{}},e.editor={form:[],schema:{},options:{},model:{}},e.field={form:[],schema:{},model:{},options:{}}}return e.prototype.dropControl=function(e){if(e.remove(),e.$modelValue.key){e.$modelValue.key&&"string"==typeof e.$modelValue.key&&(e.$modelValue.key=e.$modelValue.key.split("."));for(var o=this.$scope.editor.schema.properties,t=0;t<e.$modelValue.key.length;t++)t===e.$modelValue.key.length-1?delete o[e.$modelValue.key[t]]:o=o[e.$modelValue.key[t]].properties}},e.prototype.editControl=function(e){var o=this.toolsBuilder.getControlProperties(e.item.type),t={$id:e.$id,form:[],schema:{type:"object",properties:{schema:{type:"object"}}},model:e.item,options:{}};s.forEach(o,function(e,o){var r={type:n.DefaultFormTypes.fieldset,items:[]};s.forEach(e,function(e,o){r.items.push(s.extend({schema:{}},e))}),t.form.push(r)}),this.$scope.field=t},e.prototype.collapseAll=function(){this.$scope.$broadcast("angular-ui-tree:collapse-all")},e.prototype.expandAll=function(){this.$scope.$broadcast("angular-ui-tree:expand-all")},e.prototype.nodeToggle=function(e){e.toggle()},e.prototype.initControl=function(e){void 0!==e.items&&(e.container="items")},e.prototype.viewCode=function(){this.$modal.open({template:'<div><textarea style="width: 100%; height: 400px" ng-model="$data"></textarea></div>',scope:s.extend(this.$rootScope.$new(),{$data:JSON.stringify(this.$scope.editor)}),size:"lg"})},e.prototype.preview=function(){this.$modal.open({templateUrl:"/SeedModules.PageBuilder/modules/components/builder/preview.html",size:"9",windowClass:"right",scope:this.$scope})},e.prototype.back=function(){this.$state.go("admin.pagebuilder_page")},e.$inject=["$scope","$rootScope","$state","$modal","SeedModules.PageBuilder/modules/providers/toolsBuilder","SeedModules.AngularUI/modules/factories/ngTableParams"],e}();t.controller("SeedModules.PageBuilder/modules/components/builder/pageForm",i)}),define("SeedModules.PageBuilder/modules/components/builder/preview",["require","exports","SeedModules.PageBuilder/modules/module"],function(e,o,t){"use strict";o.__esModule=!0;var s=function(){function e(e){this.$scope=e}return e.prototype.init=function(){this.$scope.$emit("schemaFormRedraw")},e.$inject=["$scope"],e}();t.controller("SeedModules.PageBuilder/modules/components/builder/preview",s)}),define("SeedModules.PageBuilder/modules/components/toolbox/builderToolbox",["require","exports","SeedModules.PageBuilder/modules/module"],function(e,o,t){"use strict";function s(){return{replace:!0,restrict:"EA",templateUrl:"/SeedModules.PageBuilder/modules/components/toolbox/builderToolbox.html",scope:{editor:"="},controller:r}}o.__esModule=!0;var r=function(){function e(e,o){this.$scope=e,this.toolsBuilder=o;var t=this;e.toolsConfigs={beforeDrop:function(s){if(s.dest.nodesScope.$treeScope.$id===s.source.nodesScope.$treeScope.$id)return!1;var r=o.getControl(s.dest.nodesScope&&s.source.nodeScope.item?s.source.nodeScope.item.type:null);if(r){var n={type:r.type,title:r.name,container:r.container?r.container:void 0};"string"==typeof n.container&&n.container.length>0?n[n.container]=[]:"boolean"==typeof n.container&&n.container===!0?(n.container="items",n[n.container]=[]):(n.key="_"+n.type+"_"+t.uuid(10),e.editor.schema.type="object",e.editor.schema.properties=e.editor.schema.properties||{},e.editor.schema.properties[n.key]={type:"string"}),s.dest.nodesScope.$modelValue.splice(s.dest.index,0,n)}return!1}},e.tools=o.getControls()}return e.prototype.uuid=function(e,o){var t,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[];if(o=o||s.length,e)for(t=0;t<e;t++)r[t]=s[0|Math.random()*o];else{var n;for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",t=0;t<36;t++)r[t]||(n=0|16*Math.random(),r[t]=s[19==t?3&n|8:n])}return r.join("")},e.$inject=["$scope","SeedModules.PageBuilder/modules/providers/toolsBuilder"],e}();t.directive("builderToolbox",s)}),define("SeedModules.PageBuilder/modules/components/datasource/list",["require","exports","SeedModules.PageBuilder/modules/module"],function(e,o,t){"use strict";o.__esModule=!0;var s=function(){function e(e,o,t,s){this.$scope=e,this.$state=o,this.$modal=t,this.popupService=s,e.dslist=this}return e.prototype.add=function(){this.$state.go("admin.pagebuilder_dsform")},e.$inject=["$scope","$state","$modal","app/services/popupService"],e}();t.controller("SeedModules.PageBuilder/modules/components/datasource/list",s)}),define("SeedModules.PageBuilder/modules/components/datasource/form",["require","exports","SeedModules.PageBuilder/modules/module"],function(e,o,t){"use strict";o.__esModule=!0;var s=function(){function e(e,o,t,s){this.$scope=e,this.$state=o,this.$modal=t,this.popupService=s,e.dsform=this}return e.prototype.cancel=function(){this.$state.go("admin.pagebuilder_datasource")},e.$inject=["$scope","$state","$modal","app/services/popupService"],e}();t.controller("SeedModules.PageBuilder/modules/components/datasource/form",s)}),define("SeedModules.PageBuilder/modules/components/datasource/baseinfo",["require","exports","SeedModules.PageBuilder/modules/module","SeedModules.AngularUI/modules/configs/enums/defaultFormTypes"],function(e,o,t,s){"use strict";o.__esModule=!0;var r=function(){function e(e,o,t,r){this.$scope=e,this.$state=o,this.$modal=t,this.popupService=r,e.vm=this,e.sfForm={form:[{type:s.DefaultFormTypes.section,htmlClass:"row",items:[{type:s.DefaultFormTypes.section,htmlClass:"col-md-6",items:["name"]},{type:s.DefaultFormTypes.section,htmlClass:"col-md-6",items:[{key:"sourceType",type:s.DefaultFormTypes.select}]}]},{type:s.DefaultFormTypes.textarea,key:"description"}],model:{},options:{},schema:{type:"object",properties:{name:{type:"string",title:"名称",required:!0},description:{type:"string",title:"描述"},sourceType:{type:"string",title:"类型",required:!0}}}}}return e.$inject=["$scope","$state","$modal","app/services/popupService"],e}();t.controller("SeedModules.PageBuilder/modules/components/datasource/baseinfo",r)}),define("SeedModules.PageBuilder/modules/components/datasource/fields",["require","exports","SeedModules.PageBuilder/modules/module"],function(e,o,t){"use strict";o.__esModule=!0;var s=function(){function e(e){this.$scope=e}return e.$inject=["$scope"],e}();t.controller("SeedModules.PageBuilder/modules/components/datasource/fields",s)}),define("SeedModules.PageBuilder/modules/configs/enums",["require","exports"],function(e,o){"use strict";o.__esModule=!0;var t;!function(e){e[e["页面"]=0]="页面",e[e["表"]=1]="表",e[e["数据源"]=2]="数据源"}(t=o.BuilderDefineTypes||(o.BuilderDefineTypes={}));var s;!function(e){e[e["字符串"]=0]="字符串",e[e["整数"]=1]="整数",e[e["小数"]=2]="小数",e[e["浮点数"]=3]="浮点数",e[e["日期时间"]=4]="日期时间"}(s=o.DataTypes||(o.DataTypes={}))}),define("SeedModules.PageBuilder/modules/components/database/forms",["require","exports","SeedModules.AngularUI/modules/configs/enums/defaultFormTypes"],function(e,o,t){"use strict";o.__esModule=!0,o.tableform=function(e){return{formParams:e.properties({name:{title:"表名",type:"string",required:!0},description:{title:"说明",type:"string"},remark:{title:"中文名",type:"string"}}),form:[{type:t.DefaultFormTypes.section,htmlClass:"row",items:[{type:t.DefaultFormTypes.section,htmlClass:"col-md-6",items:["name"]},{type:t.DefaultFormTypes.section,htmlClass:"col-md-6",items:["remark"]}]},{key:"description",type:t.DefaultFormTypes.textarea}]}}}),define("SeedModules.PageBuilder/modules/components/database/table",["require","exports","SeedModules.PageBuilder/modules/module","angular","SeedModules.PageBuilder/modules/configs/enums","SeedModules.PageBuilder/modules/components/database/forms"],function(e,o,t,s,r,n){"use strict";o.__esModule=!0;var i=function(){function e(e,o,t,s,r,n,i){this.$scope=e,this.$rootScope=o,this.$state=t,this.$modal=s,this.popupService=r,this.requestService=n,this.schemaFormParams=i,e.vm=this,e.list=[],e.search={keyword:""}}return e.prototype.load=function(){var e=this;this.requestService.url("/api/pagebuilder/define/"+r.BuilderDefineTypes.表).options({showLoading:!1}).get().result.then(function(o){e.$scope.list=o})},e.prototype.add=function(){var e=this;this.$modal.open({templateUrl:"/SeedModules.AngularUI/modules/views/schemaConfirm.html",scope:s.extend(this.$rootScope.$new(),{$data:$.extend({title:"添加表",model:{}},n.tableform(new this.schemaFormParams))})}).result.then(function(o){e.requestService.url("/api/pagebuilder/define").put({type:r.BuilderDefineTypes.表,properties:o}).result.then(function(o){e.load()})})},e.prototype.edit=function(e){var o=this;this.$modal.open({templateUrl:"/SeedModules.AngularUI/modules/views/schemaConfirm.html",scope:s.extend(this.$rootScope.$new(),{$data:$.extend({title:"编辑表",model:$.extend({},e.properties)},n.tableform(new this.schemaFormParams))})}).result.then(function(t){o.requestService.url("/api/pagebuilder/define").put({id:e.id,type:r.BuilderDefineTypes.表,properties:t}).result.then(function(e){o.load()})})},e.prototype.columns=function(e){var o=this;this.$modal.open({templateUrl:"/SeedModules.PageBuilder/modules/components/database/tableColumns.html",scope:s.extend(this.$rootScope.$new(),{$data:{title:e.properties.name+" - "+e.properties.remark,model:$.extend({},e.properties)}}),size:"lg"}).result.then(function(t){o.requestService.url("/api/pagebuilder/define").put({id:e.id,type:r.BuilderDefineTypes.表,properties:t}).result.then(function(e){})})},e.prototype.drop=function(e){var o=this;this.popupService.confirm("是否删除？").ok(function(){o.requestService.url("/api/pagebuilder/define/"+e.id).drop().result.then(function(e){o.load()})})},e.prototype.fire=function(){this.requestService.url("/api/pagebuilder/table/fire").patch().result.then(function(e){})},e.$inject=["$scope","$rootScope","$state","$modal","app/services/popupService","SeedModules.AngularUI/modules/services/requestService","SeedModules.AngularUI/modules/factories/schemaFormParams"],e}();t.controller("SeedModules.PageBuilder/modules/components/database/table",i)}),define("SeedModules.PageBuilder/modules/components/database/tableColumns",["require","exports","SeedModules.PageBuilder/modules/module","SeedModules.PageBuilder/modules/components/database/forms","SeedModules.PageBuilder/modules/configs/enums"],function(e,o,t,s,r){"use strict";o.__esModule=!0;var n=function(){function e(e,o){this.$scope=e,this.schemaFormParams=o,e.vm=this,e.dataTypes=r.DataTypes,e.$data=$.extend(e.$data||{},s.tableform(new o)),e.newColumn={}}return e.prototype.lengthDisabled=function(e){return e.type!==r.DataTypes.字符串+""&&e.type!==r.DataTypes.小数+""},e.prototype.accuracyDisabled=function(e){return e.type!==r.DataTypes.小数+""},e.prototype.addColumn=function(){this.$scope.$data.model.columns=this.$scope.$data.model.columns||[],this.$scope.$data.model.columns.push($.extend({},this.$scope.newColumn)),this.$scope.newColumn={}},e.prototype.removeColumn=function(e){this.$scope.$data.model.columns.splice(e,1)},e.$inject=["$scope","SeedModules.AngularUI/modules/factories/schemaFormParams"],e}();t.controller("SeedModules.PageBuilder/modules/components/database/tableColumns",n)}),define("SeedModules.PageBuilder/modules/components/three/page",["require","exports","SeedModules.PageBuilder/modules/module","three"],function(e,o,t,s){"use strict";o.__esModule=!0;var r=function(){function e(e){var o=this;e.rotation.set(0,0,0),this._pitchObject=new s.Object3D,this._pitchObject.add(e),this._yawObject=new s.Object3D,this._yawObject.position.y=10,this._yawObject.add(this._pitchObject),this._PI_2=Math.PI/2,this._onMouseMove=function(e){if(o.enabled){var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,s=e.movementY||e.mozMovementY||e.webkitMovementY||0;o._yawObject.rotation.y-=.002*t,o._pitchObject.rotation.x-=.002*s,o._pitchObject.rotation.x=Math.max(-o._PI_2,Math.min(o._PI_2,o._pitchObject.rotation.x))}},document.addEventListener("mousemove",this._onMouseMove,!1),this.enabled=!1,this.getDirection=function(){var e=new s.Vector3(0,0,(-1)),t=new s.Euler(0,0,0,"YXZ");return function(s){return t.set(o._pitchObject.rotation.x,o._yawObject.rotation.y,0),s.copy(e).applyEuler(t),s}}()}return e.prototype.dispose=function(){document.removeEventListener("mousemove",this._onMouseMove,!1)},e.prototype.getObject=function(){return this._yawObject},e.prototype.getDirection=function(e){return e},e.prototype._onMouseMove=function(e){},e}(),n=function(){function e(e,o){function t(){requestAnimationFrame(t),n()}function n(){if(e.controlsEnabled===!0){u.ray.origin.copy(F.getObject().position),u.ray.origin.y-=10;var o=u.intersectObjects($),t=o.length>0,s=performance.now(),r=(s-f)/1e3;h.x-=10*h.x*r,h.z-=10*h.z*r,h.y-=9.8*100*r,g.z=Number(l)-Number(a),g.x=Number(c)-Number(p),g.normalize(),(l||a)&&(h.z-=400*g.z*r),(c||p)&&(h.x-=400*g.x*r),t===!0&&(h.y=Math.max(0,h.y),m=!0),F.getObject().translateX(h.x*r),F.getObject().translateY(h.y*r),F.getObject().translateZ(h.z*r),F.getObject().position.y<10&&(h.y=0,F.getObject().position.y=10,m=!0),f=s}T.render(i,d)}this.$scope=e,this.$element=o,e.vm=this;var i=new s.Scene,d=new s.PerspectiveCamera(75,o.innerWidth()/600,.1,1e3);e.controlsEnabled=!1;var u,l=!1,a=!1,c=!1,p=!1,m=!1,f=performance.now(),h=new s.Vector3,g=new s.Vector3,y=new s.Vector3,b=new s.Color,$=[],M=function(e){switch(e.keyCode){case 38:case 87:l=!0;break;case 37:case 65:c=!0;break;case 40:case 83:a=!0;break;case 39:case 68:p=!0;break;case 32:m===!0&&(h.y+=350),m=!1}},S=function(e){switch(e.keyCode){case 38:case 87:l=!1;break;case 37:case 65:c=!1;break;case 40:case 83:a=!1;break;case 39:case 68:p=!1}},v=function(o){document.pointerLockElement===document.body||document.mozPointerLockElement===document.body||document.webkitPointerLockElement===document.body?(e.controlsEnabled=!0,F.enabled=!0):(F.enabled=!1,e.controlsEnabled=!1)};document.addEventListener("keydown",M,!1),document.addEventListener("keyup",S,!1),document.addEventListener("pointerlockchange",v,!1),document.addEventListener("mozpointerlockchange",v,!1),document.addEventListener("webkitpointerlockchange",v,!1),u=new s.Raycaster(new s.Vector3,new s.Vector3(0,(-1),0),0,10);var P=new s.PlaneBufferGeometry(2e3,2e3,100,100);P.rotateX(-Math.PI/2);for(var B=P.attributes.position,w=0,_=B.count;w<_;w++)y.fromBufferAttribute(B,w),y.x+=20*Math.random()-10,y.y+=2*Math.random(),y.z+=20*Math.random()-10,B.setXYZ(w,y.x,y.y,y.z);P=P.toNonIndexed(),B=P.attributes.position;for(var x=[],w=0,_=B.count;w<_;w++)b.setHSL(.3*Math.random()+.5,.75,.25*Math.random()+.75),x.push(b.r,b.g,b.b);P.addAttribute("color",new s.Float32BufferAttribute(x,3));var k=new s.MeshBasicMaterial({vertexColors:s.VertexColors}),j=new s.Mesh(P,k);i.add(j);var T=new s.WebGLRenderer;T.setSize(o.innerWidth(),600),o.append(T.domElement);var C=new s.CubeGeometry(1,1,1),q=new s.MeshBasicMaterial({color:65280}),D=new s.Mesh(C,q);i.add(D),d.position.z=5,e.scene=i,e.camera=d,e.renderer=T,e.cube=D;var F=new r(d);i.add(F.getObject()),this.controls=F,t()}return e.prototype.lockpointer=function(){var e=document.body,o="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document;o&&(e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock,e.requestPointerLock(),this.controls.enabled=!0,this.$scope.controlsEnabled=!0)},e.prototype.keydown=function(e){switch(e.keyCode){case 27:this.controls.enabled=!1,this.$scope.controlsEnabled=!1}},e.$inject=["$scope","$element"],e}();t.controller("SeedModules.PageBuilder/modules/components/three/page",n)}),define("SeedModules.PageBuilder/modules/controllers/pageCommon",["require","exports","SeedModules.PageBuilder/modules/module"],function(e,o,t){"use strict";o.__esModule=!0;var s=function(){function e(e){this.$scope=e,e.pageCommon=this}return e.prototype.datasource=function(e){},e.$inject=["$scope"],e}();t.controller("SeedModules.PageBuilder/modules/controllers/pageCommon",s)}),define("SeedModules.PageBuilder/modules/requires",["require","exports","SeedModules.PageBuilder/modules/components/builder/page","SeedModules.PageBuilder/modules/components/server/settings","SeedModules.PageBuilder/modules/components/builder/pageForm","SeedModules.PageBuilder/modules/components/builder/preview","SeedModules.PageBuilder/modules/components/toolbox/builderToolbox","SeedModules.PageBuilder/modules/components/datasource/list","SeedModules.PageBuilder/modules/components/datasource/form","SeedModules.PageBuilder/modules/components/datasource/baseinfo","SeedModules.PageBuilder/modules/components/datasource/fields","SeedModules.PageBuilder/modules/components/database/table","SeedModules.PageBuilder/modules/components/database/tableColumns","SeedModules.PageBuilder/modules/components/three/page","SeedModules.PageBuilder/modules/controllers/pageCommon"],function(e,o){"use strict";o.__esModule=!0});